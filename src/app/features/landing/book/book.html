<div class="reclamaciones-container">
  <mat-card class="reclamaciones-card">
    <mat-card-header>
      <mat-card-title>Libro de Reclamaciones</mat-card-title>
      <mat-card-subtitle>Complete el formulario con sus datos</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <form
        [formGroup]="reclamacionForm"
        (ngSubmit)="onSubmit()"
        #formDirective="ngForm"
        ngNoForm
      >

        <!-- Fecha -->
        <div class="form-section">
          <h3 class="section-title">Fecha del Reclamo</h3>
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Seleccione una fecha</mat-label>
            <input matInput [matDatepicker]="picker" formControlName="fecha" [max]="maxDate" >
            <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
            <mat-error *ngIf="shouldShowError('fecha')">
              {{ getErrorMessage('fecha') }}
            </mat-error>
          </mat-form-field>
        </div>

        <!-- Identificación del Usuario -->
        <div class="form-section">
          <h3 class="section-title">Identificación del Usuario o Tercero Legitimado (Reclamante)</h3>

          <div class="form-row three-columns">
            <mat-form-field appearance="outline">
              <mat-label>Nombres</mat-label>
              <input matInput formControlName="nombres" placeholder="Ingrese sus nombres">
              <mat-error *ngIf="shouldShowError('nombres')" >
                {{ getErrorMessage('nombres') }}
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Apellido Paterno</mat-label>
              <input matInput formControlName="apellidoPaterno" placeholder="Apellido paterno">
              <mat-error *ngIf="shouldShowError('apellidoPaterno')">
                {{ getErrorMessage('apellidoPaterno') }}
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Apellido Materno</mat-label>
              <input matInput formControlName="apellidoMaterno" placeholder="Apellido materno">
              <mat-error *ngIf="shouldShowError('apellidoMaterno')">
                {{ getErrorMessage('apellidoMaterno') }}
              </mat-error>
            </mat-form-field>
          </div>

          <div class="form-row three-columns">
            <mat-form-field appearance="outline">
              <mat-label>Documento de Identidad</mat-label>
              <mat-select formControlName="tipoDocumento">
                <mat-option *ngFor="let tipo of tiposDocumento" [value]="tipo.value">
                  {{ tipo.label }}
                </mat-option>
              </mat-select>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Número de Documento</mat-label>
              <input matInput formControlName="numeroDocumento" placeholder="Ej: 12345678">
              <mat-error *ngIf="shouldShowError('numeroDocumento')">
                {{ getErrorMessage('numeroDocumento') }}
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>E-mail</mat-label>
              <input matInput type="email" formControlName="email" placeholder="ejemplo@correo.com">
              <mat-icon matPrefix>email</mat-icon>
              <mat-error *ngIf="shouldShowError('email')">
                {{ getErrorMessage('email') }}
              </mat-error>
            </mat-form-field>
          </div>

          <div class="form-row two-columns">
            <mat-form-field appearance="outline">
              <mat-label>Teléfono Fijo</mat-label>
              <input matInput formControlName="telefonoFijo" placeholder="Ej: 014567890">
              <mat-icon matPrefix>phone</mat-icon>
              <mat-error *ngIf="shouldShowError('telefonoFijo')">
                {{ getErrorMessage('telefonoFijo') }}
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Teléfono Celular</mat-label>
              <input matInput formControlName="telefonoCelular" placeholder="Ej: 987654321">
              <mat-icon matPrefix>smartphone</mat-icon>
              <mat-error *ngIf="shouldShowError('telefonoCelular')">
                {{ getErrorMessage('telefonoCelular') }}
              </mat-error>
            </mat-form-field>
          </div>

          <div class="form-row three-columns">
            <mat-form-field appearance="outline">
              <mat-label>Dirección</mat-label>
              <input matInput formControlName="direccion" placeholder="Calle, avenida, número">
              <mat-icon matPrefix>home</mat-icon>
              <mat-error *ngIf="shouldShowError('direccion')">
                {{ getErrorMessage('direccion') }}
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Distrito</mat-label>
              <input matInput formControlName="distrito" placeholder="Distrito">
              <mat-error *ngIf="shouldShowError('distrito')">
                {{ getErrorMessage('distrito') }}
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Departamento</mat-label>
              <mat-select formControlName="departamento">
                <mat-option *ngFor="let dept of departamentos" [value]="dept">
                  {{ dept }}
                </mat-option>
              </mat-select>
              <mat-error *ngIf="shouldShowError('departamento')">
                {{ getErrorMessage('departamento') }}
              </mat-error>
            </mat-form-field>
          </div>
        </div>

        <!-- Detalle del Reclamo -->
        <div class="form-section">
          <h3 class="section-title">Detalle del Reclamo</h3>
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Describa su reclamo</mat-label>
            <textarea
              matInput
              formControlName="detalleReclamo"
              rows="6"
              placeholder="Describa detalladamente su reclamo..."></textarea>
            <mat-hint align="end">{{ caracteresRestantes }} / 500</mat-hint>
            <mat-error *ngIf="shouldShowError('detalleReclamo')">
              {{ getErrorMessage('detalleReclamo') }}
            </mat-error>
          </mat-form-field>
        </div>

        <!-- Confirmación de Datos -->
        <div class="form-section">
          <h3 class="section-title">Confirmación de Datos</h3>

          <div class="checkbox-container">
            <mat-checkbox formControlName="confirmacionDatos" color="primary">
              <span class="checkbox-label">
                Estoy de acuerdo con lo ingresado en esta hoja de reclamaciones y así mismo
                confirmo que los datos son tomados como firma de esta solicitud. *
              </span>
            </mat-checkbox>
            <mat-error
              *ngIf="reclamacionForm.get('confirmacionDatos')?.invalid && reclamacionForm.get('confirmacionDatos')?.touched"
              class="checkbox-error">
              Debe aceptar la confirmación de datos
            </mat-error>
          </div>

          <div class="checkbox-container">
            <mat-checkbox formControlName="autorizacionNotificacion" color="primary">
              <span class="checkbox-label">
                Autorizo Notificación del Resultado al email consignado
              </span>
            </mat-checkbox>
          </div>
        </div>

        <!-- Botón de Enviar -->
        <div class="form-actions">
          <button
            mat-raised-button
            color="primary"
            type="submit"
            class="submit-button"
            [disabled]="reclamacionForm.invalid || isLoading">
            <mat-spinner *ngIf="isLoading" diameter="24" class="spinner-button"></mat-spinner>
            <span class="button-content" *ngIf="!isLoading">
              <mat-icon>send</mat-icon>
              <span>ENVIAR</span>
            </span>
          </button>
        </div>

        <!-- Aviso Legal -->
        <div class="legal-notice">
          <mat-icon class="warning-icon">info</mat-icon>
          <p>
            Odontpro se reserva el derecho de tomar acciones legales pertinentes en caso
            de verificarse la falsedad o inexactitud de las declaraciones realizadas.
          </p>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
